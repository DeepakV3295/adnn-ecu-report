\part{Introduction}

An embedded system is a combination of hardware and software components put together to achieve a specific task. Often, embedded systems are built into a larger device or system and are used to collect, store, process, and analyse data, as well as to control the device\textquotesingle s behaviour. Embedded devices are a category of tiny devices with physical, computational and memory constraints that are programmable to perform dedicated tasks.   
%Embedded systems are common in everyday applications due to their simplicity, flexibility and cost-effectiveness. 
Like most of the automotive industry, Scania employs embedded systems called Electronic Control Units (ECUs) in their trucks to supervise and regulate essential subsystems like the engine, transmission, braking, and electrical systems. Each of these subsystems has one or more ECUs to gather system data and transmit it to a central communicator where the data is processed and the systems operations are monitored.

Scania currently runs a massive fleet of around 600,000 connected heavy vehicles. The company's truck sales make up 62\% of its global sales and Scania has been adding 60,000 trucks to it's fleet annually. (link: https://www.scania.com/content/dam/group/investor-relations/annual-review/download-full-report/scania-annual-and-sustainability-report-2022.pdf) This large fleet of rolling vehicles that are connected though the communicators opens up new possibilities. The different connnected devices that monitor the health and state of the vehicle can be trained to predict the system maintainance accurately and efficiently. (For example, if the system can predict accurately that tire changes are required in 100kms then the driver can plan the route smartly to reach the workshop before the vehicle breaksdown.) This opportunity can be realised by running smart algorithms on the hardware that is currently available.

Machine learning (ML) on embedded devices is becoming increasingly popular due to its ability to provide real-time insight and intelligence to devices. This technology can be used to automate tasks, improve efficiency, and make better decisions. But this technology presents a unique set of challenges due to the limited resources available on these devices. Embedded devices are designed to be power efficient, have limited memory and processing power, and require closely tailored algorithms, making it difficult to use pre-existing machine learning models. Furthermore, embedded devices are often expected to produce real-time results, which further complicates the development process. Despite these challenges, machine learning on embedded devices has potential applications in a variety of areas, such as in the fields of robotics and autonomous vehicles.

One such ML application Scania has been developing in their \textsc{lobstr }\cite{lobstr} and \textsc{FAMOUS} projects is the anomaly and fault detection models in a federated learning environment. Targeting to run the anomaly detection models on the existing ECUs with limited resources has many benefits and challenges. Some of them are described below :

Benefits :
\begin{itemize}
	\item Scania is committed to promote a shift towards autonomous and eco-friendly transport systems. The latest addition of Scania's connected trucks and buses will be embedded with upgraded ECUs and communication devices. However, this upgrade will make the stock of older hardware devices to become obsolete and regarded as e-waste, which could be prevented. Exploring the possibility of repurposing existing ECUs to run ML models aligns with Scania's vision of leading the way towards a sustainable future. 
	\item Neural networks (NNs) are a type of machine learning that can detect intricate patterns not only across multiple data signals but also over time. Achieving this level of performance is computationally demanding, and training NNs on embedded devices requires careful resource management. However, being able to efficiently train NNs on embedded devices with high accuracy could unlock significant potential for future advancements. (could include benefits of NN for anomaly detection)
	\item Federated learning methods facilitate the training of pre-trained anomaly detection models on the ECUs installed in Scania's distributed fleet of connected trucks. Each ECU individually trains the model with its data and transmits the updated model parameters to a central server. This distributed learning approach enables early detection of faults or failures and ensures that critical data remains on the device. Also dependency on network bandwidth is reduced as only the aggregated model updates are communicated over the network, instead of transmitting the entire data sample.
\end{itemize}

Challenges :
\begin{itemize}
	\item To reap the best benefits of these approaches, training of the model needs to be performed on board. However much of the potential of running machine learning applications on these devices remains unattained due to the difficulties in creating these applications and running training on-board. Approaches such as TensorFlow Lite (TFLite), Edge Impulse, and STM Cube AI implemented along the TinyML frameworks, enable running ML models targeted for small resource devices. But these approaches are limited to inference and there is no open source support in the existing infrastructure for training ML models.

	\item An Original Equipment Manufacturer (OEM) is responsible for the development and upkeep of the Scania ECU. However, the amount of information made available regarding the hardware design, memory layout, and operating system (OS) is restricted. To construct an embedded OS for a customized hardware, critical details such as the device tree, memory organisation, and boot flow are necessary. Obtaining this information from a functional board can be an enormous task requiring reverse engineering expertise. 
\end{itemize}

A big gap can be observed in the development of frameworks that support the training of NN models on embedded devices and there is a need to investigate the solutions. 
% Reason : 
	% 1. Sustainabililty - check
	% 2. Potential in tiny ML (billions of devices) and Federated Learning approaches
			% Needs Training on board

% Gap  in the market: No support for training ML models on embedded devices
% Scope: Exploring the challenges of building and training NN's on embedded devices using different approaches and evaluating their performances.
% TODO: Attach a reference for the following claim

%Among the ML approaches to take, Artifical Neural Networks are especially interesting for anomaly detection due to several factors such as minimal data preprocessing \dots To get the best out of this approache, training of the model needs to be performed on-board. However much of the potential of running machine learning applications on these devices remain unattained due to the difficulties in creating these applications and running training on-board.

\subsubsection{Problem Description}
% The scope of the thesis is to repurpose the existing Scania ECU and explore the challenges of building targeted NN models and training them on repurposed ECU using different approaches and evaluating their performances.

The objective of this thesis is to repurpose the present Scania ECU and investigate the difficulties in building targeted neural network models. The models implemented with different approaches will then be trained on the repurposed ECU, and their effectiveness will be assessed.

%The scope of the thesis is to explore the challenges of building and training artificial neural networks on embedded devices using different approaches and evaluating their performance.

%An important feature of machine learning applications are their iterative improvement process. For neural network applications this happens during the training process which traditionally consumes a lot of compute resource

% \subsubsection{Why perform training and inference on ECUs?}

% In the world of embedded systems resources such as compute, memory, network bandwith etc. are all limited. The traditional model of sending data from embedded device sensors off-board to compute clusters on the cloud presents several challenges such as bandwith consumption, privacy considerations, and more that makes it attractive to perform both training and inference on-board the embedded device

% \paragraph{Federated Learning}{
% 	One approach to making this training loop take place from within these platforms is Federated Learning which cruicially allows for the data to remain on the device
% }

\chapter{Background}

The development and maintainance of neural network applications on a fleet of embedded devices has several design considerations and relies heavily on technological innovations. This makes embedded linux an attractive platform to build these applications and motivates an examination of build systems that target embedded environments.

\section[Development Process for Embedded Linux]{Development For Embedded Linux}

Build systems are . An overview is presented in Appendix \hyperref[buildsystems]{I}

\subsection[SDKs \& Compiler Toolchains]{Toolchains \& Cross compilers}
\textit{Describe their usage. Will show up again in Development chapter}

Support for embedded hardware requires a stack that includes several software components covered in this chapter. The initial target machine was an ECU filling the role of a coordinator on the truck, however due to certain components missing from are contained in the Appendix \hyperref[rtc-c300]{II}

\section{Training on Device}

\textit{Mention traditional offboard training and onboard inference architecture vs approaches with training on board. Reference Tiny ML research}

\subsection{Federated Learning}

\textit{link to federated learning, mention FAMOUS again}

\section[Development of Neural Network Application]{Development Of Neural Network Application}
\textit{Contrast general purpose frameworks - TFlite etc with handwritten applications}

\subsection{Different Programming Paradigms}
\textit{Approaches to doing Machine Learning in Embedded Environments. Emphasis on how these applications are developed - e.g TFLite}

\section{General Distribution of Work}

\chapter{Theory}

\section[Artificial Neural Network (ANN)]{Artificial Neural Networks}
\textit{General introduction to ANNs. Explaining topics from inference, training, till federated learning systems}

\section{ANN Performance Optimisations Techniques}
\textit{Contrast traditional implementations in resource rich environments and the constraints of embedded environment. Layout general strategies to acquire performance improvements with little losses to accuracy - Purning, Quantisation}

\section{Hardware Support for Neural Networks}
\textit{Introduction to ARM-NN kernels, mentioned again in Development chapter}

\section{Embedded Linux}
\textit{Describe the process of boot flow introducing concepts such as Boot ROM, eMMC, IVT, bootloader, kernel, file systems etc.}

\section{Performance Evaluation}
\textit{Describe and motivate performance measures used in the Results chapter}
